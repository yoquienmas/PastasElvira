<Window x:Class="CapaPresentacion.FormVenta"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Registro de Venta - Pastas Elvira" Height="800" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#fff8e1"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded">

    <Window.Resources>
        <!-- Estilos para el DataGrid -->
        <Style x:Key="DataGridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#a36b00"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style x:Key="CenterAlignStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="RightAlignStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
        </Style>

        <!-- Estilo para botones con esquinas redondeadas -->
        <Style x:Key="RoundedButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo para el ComboBox de métodos de pago -->
        <Style x:Key="MetodoPagoComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Height" Value="35"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#d4b483"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#5c3a00"/>
            <Setter Property="Padding" Value="8,4"/>
        </Style>
    </Window.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Border Background="White" Padding="25" BorderBrush="#e2a42d" BorderThickness="2" Margin="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="200"/>
                    <!-- Altura fija para el DataGrid -->
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Encabezado -->
                <Border Grid.Row="0" Background="#a36b00" Padding="15" Margin="0,0,0,20">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="🛍️" FontSize="28" Margin="0,0,15,0"/>
                        <TextBlock Text="REGISTRO DE VENTA" 
                                   FontSize="22" 
                                   FontWeight="Bold"
                                   Foreground="White"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Información de la Venta -->
                <GroupBox Grid.Row="1" Header="INFORMACIÓN DE LA VENTA" 
                          FontWeight="SemiBold" 
                          Foreground="#a36b00"
                          FontSize="13"
                          BorderBrush="#e2a42d"
                          BorderThickness="2">
                    <Grid Margin="15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Información del Cliente -->
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="CLIENTE" 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="12"
                                       Margin="0,0,0,8"/>

                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,15">
                                <TextBox x:Name="txtCliente" 
                                         Width="220" 
                                         Height="32" 
                                         IsReadOnly="True"
                                         Text="CONSUMIDOR FINAL"
                                         FontWeight="SemiBold"
                                         Foreground="#5c3a00"
                                         Background="#f8f8f8"
                                         BorderBrush="#d4b483"
                                         Padding="8,4"/>
                                <Button x:Name="btnBuscarCliente" 
                                        Content="🔍 Buscar" 
                                        Width="90" 
                                        Height="32" 
                                        Margin="12,0,0,0"
                                        Background="#a36b00"
                                        Style="{StaticResource RoundedButtonStyle}"
                                        Click="btnBuscarCliente_Click"/>
                            </StackPanel>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="15"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="DOCUMENTO" 
                                               FontWeight="Bold" 
                                               Foreground="#5c3a00" 
                                               FontSize="11"
                                               Margin="0,0,0,5"/>
                                    <TextBox x:Name="txtDocumentoCliente" 
                                             Height="32" 
                                             IsReadOnly="True"
                                             Background="#f8f8f8"
                                             BorderBrush="#d4b483"
                                             Padding="8,4"
                                             FontWeight="SemiBold"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="TELÉFONO" 
                                               FontWeight="Bold" 
                                               Foreground="#5c3a00" 
                                               FontSize="11"
                                               Margin="0,0,0,5"/>
                                    <TextBox x:Name="txtTelefonoCliente" 
                                             Height="32" 
                                             IsReadOnly="True"
                                             Background="#f8f8f8"
                                             BorderBrush="#d4b483"
                                             Padding="8,4"
                                             FontWeight="SemiBold"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>

                        <!-- Separador -->
                        <Rectangle Grid.Column="1" 
                                   Fill="#e2a42d" 
                                   Width="2" 
                                   VerticalAlignment="Stretch"
                                   Margin="0,10"
                                   Opacity="0.5"/>

                        <!-- Información del Vendedor -->
                        <StackPanel Grid.Column="2" Margin="15,0,0,0">
                            <TextBlock Text="VENDEDOR" 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="12"
                                       Margin="0,0,0,8"/>
                            <Border Background="#f8f8f8" 
                                    BorderBrush="#d4b483" 
                                    BorderThickness="1"
                                    Height="32"
                                    Padding="8,4">
                                <TextBlock x:Name="txtVendedor" 
                                           VerticalAlignment="Center" 
                                           FontWeight="SemiBold" 
                                           Foreground="#a36b00" 
                                           Text="Cargando..."/>
                            </Border>

                            <TextBlock Text="FECHA Y HORA" 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="12"
                                       Margin="0,15,0,8"/>
                            <Border Background="#f8f8f8" 
                                    BorderBrush="#d4b483" 
                                    BorderThickness="1"
                                    Height="32"
                                    Padding="8,4">
                                <TextBlock x:Name="txtFecha" 
                                           VerticalAlignment="Center" 
                                           FontWeight="SemiBold"/>
                            </Border>
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <!-- Método de Pago - ACTUALIZADO A COMBOBOX -->
                <!-- Método de Pago - ACTUALIZADO A COMBOBOX -->
                <GroupBox Grid.Row="2" 
          Header="MÉTODO DE PAGO" 
          FontWeight="SemiBold" 
          Foreground="#a36b00"
          FontSize="13"
          BorderBrush="#e2a42d"
          BorderThickness="2"
          Margin="0,15,0,0">
                    <Grid Margin="15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="SELECCIONE MÉTODO DE PAGO:" 
                   FontWeight="Bold" 
                   Foreground="#5c3a00" 
                   VerticalAlignment="Center"
                   Margin="0,0,15,0"/>

                        <ComboBox x:Name="cboMetodoPago"
                  Grid.Column="1"
                  Style="{StaticResource MetodoPagoComboBoxStyle}"
                  Width="300"
                  HorizontalAlignment="Left">
                            <!-- ✅ SOLUCIÓN: ItemTemplate simplificado -->
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding TextoItem}" 
                               FontSize="12"
                               FontWeight="SemiBold"
                               Foreground="#5c3a00"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </Grid>
                </GroupBox>

                <!-- Selección de Productos -->
                <GroupBox Grid.Row="3" 
                          Header="SELECCIÓN DE PRODUCTOS" 
                          FontWeight="SemiBold" 
                          Foreground="#a36b00"
                          FontSize="13"
                          BorderBrush="#e2a42d"
                          BorderThickness="2"
                          Margin="0,15,0,0">
                    <Grid Margin="15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Producto -->
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="PRODUCTO" 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="11"
                                       Margin="0,0,0,5"/>
                            <ComboBox x:Name="cboProductos" 
                                      Width="280" 
                                      Height="35" 
                                      Margin="0,0,0,0"
                                      SelectionChanged="cboProductos_SelectionChanged"
                                      Background="White"
                                      BorderBrush="#d4b483">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="4">
                                            <TextBlock Text="{Binding Nombre}" 
                                                       FontWeight="Bold" 
                                                       Foreground="#a36b00" 
                                                       Margin="0,0,8,0"
                                                       MinWidth="60"/>
                                            
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>

                        <!-- Cantidad -->
                        <StackPanel Grid.Column="1" Margin="20,0,0,0">
                            <TextBlock Text="CANTIDAD" 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="11"
                                       Margin="0,0,0,5"/>
                            <TextBox x:Name="txtCantidad" 
                                     Width="90" 
                                     Height="35" 
                                     Text="1"
                                     TextAlignment="Center"
                                     FontWeight="SemiBold"
                                     Background="White"
                                     BorderBrush="#d4b483"
                                     Padding="8,4"/>
                        </StackPanel>

                        <!-- Precio -->
                        <StackPanel Grid.Column="2" Margin="20,0,0,0">
                            <TextBlock Text="PRECIO UNIT." 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="11"
                                       Margin="0,0,0,5"/>
                            <TextBox x:Name="txtPrecioUnitario" 
                                     Width="110" 
                                     Height="35" 
                                     IsReadOnly="True"
                                     Background="#f8f8f8"
                                     BorderBrush="#d4b483"
                                     FontWeight="SemiBold"
                                     Foreground="#a36b00"
                                     Padding="8,4"
                                     TextAlignment="Right"/>
                        </StackPanel>

                        <!-- Stock -->
                        <StackPanel Grid.Column="3" Margin="20,0,0,0">
                            <TextBlock Text="STOCK DISP." 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00" 
                                       FontSize="11"
                                       Margin="0,0,0,5"/>
                            <Border Background="#f8f8f8" 
                                    BorderBrush="#d4b483" 
                                    BorderThickness="1"
                                    Width="90" 
                                    Height="35"
                                    Padding="8,4">
                                <TextBlock x:Name="txtStockDisponible" 
                                           VerticalAlignment="Center" 
                                           FontWeight="SemiBold"
                                           Foreground="#5c3a00"
                                           TextAlignment="Center"/>
                            </Border>
                        </StackPanel>

                        <!-- Botón Agregar -->
                        <StackPanel Grid.Column="5" VerticalAlignment="Bottom" Margin="20,0,0,0">
                            <Button x:Name="btnAgregar" 
                                    Content="➕ AGREGAR" 
                                    Width="130" 
                                    Height="40"
                                    Background="#4CAF50" 
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Click="btnAgregar_Click"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <!-- Detalle de la Venta - CORREGIDO -->
                <GroupBox Grid.Row="4" 
                          Header="DETALLE DE LA VENTA" 
                          Margin="0,15,0,0" 
                          FontWeight="SemiBold" 
                          Foreground="#a36b00"
                          FontSize="13"
                          BorderBrush="#e2a42d"
                          BorderThickness="2">
                    <Grid>
                        <DataGrid x:Name="dgvItemsVenta" 
                                  AutoGenerateColumns="False" 
                                  IsReadOnly="True" 
                                  Background="White" 
                                  BorderThickness="0"
                                  HeadersVisibility="Column"
                                  RowHeight="35"
                                  FontSize="12"
                                  HorizontalGridLinesBrush="#f0f0f0"
                                  VerticalGridLinesBrush="#f0f0f0"
                                  VerticalAlignment="Stretch"
                                  HorizontalAlignment="Stretch"
                                  ScrollViewer.VerticalScrollBarVisibility="Auto" SelectionChanged="dgvItemsVenta_SelectionChanged">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRODUCTO" 
                                                    Binding="{Binding NombreProducto}" 
                                                    Width="*"
                                                    HeaderStyle="{StaticResource DataGridHeaderStyle}"/>
                                <DataGridTextColumn Header="CANTIDAD" 
                                                    Binding="{Binding Cantidad}" 
                                                    Width="90"
                                                    HeaderStyle="{StaticResource DataGridHeaderStyle}"
                                                    ElementStyle="{StaticResource CenterAlignStyle}"/>
                                <DataGridTextColumn Header="PRECIO UNIT." 
                                                    Binding="{Binding PrecioUnitario, StringFormat=C}" 
                                                    Width="120"
                                                    HeaderStyle="{StaticResource DataGridHeaderStyle}"
                                                    ElementStyle="{StaticResource RightAlignStyle}"/>
                                <DataGridTextColumn Header="SUBTOTAL" 
                                                    Binding="{Binding Subtotal, StringFormat=C}" 
                                                    Width="130"
                                                    HeaderStyle="{StaticResource DataGridHeaderStyle}"
                                                    ElementStyle="{StaticResource RightAlignStyle}"/>
                                <DataGridTemplateColumn Header="" 
                                                        Width="70"
                                                        HeaderStyle="{StaticResource DataGridHeaderStyle}">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="🗑️" 
                                                    Background="#f44336" 
                                                    Foreground="White" 
                                                    Padding="8,4"
                                                    FontSize="10"
                                                    BorderThickness="0"
                                                    Cursor="Hand"
                                                    Click="btnEliminar_Click" 
                                                    ToolTip="Eliminar producto"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </GroupBox>

                <!-- Pie de Página - Total y Botones -->
                <Border Grid.Row="5" 
                        Background="#f8f8f8" 
                        Padding="20" 
                        Margin="0,20,0,0"
                        BorderBrush="#d4b483"
                        BorderThickness="1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Total -->
                        <StackPanel Grid.Column="0" Orientation="Vertical" VerticalAlignment="Center">
                            <TextBlock Text="TOTAL DE LA VENTA" 
                                       FontSize="14" 
                                       FontWeight="Bold" 
                                       Foreground="#5c3a00"/>
                            <TextBlock x:Name="txtTotalVenta" 
                                       FontSize="28" 
                                       FontWeight="Bold" 
                                       Foreground="#e53935" 
                                       Text="$ 0.00" 
                                       Margin="0,5,0,0"/>
                        </StackPanel>

                        <!-- Botones -->
                        <StackPanel Grid.Column="2" 
                                    Orientation="Horizontal" 
                                    VerticalAlignment="Center">

                            <Button x:Name="btnRegistrarVenta" 
                                    Content="✅ REGISTRAR VENTA" 
                                    Width="170" 
                                    Height="45"
                                    Background="#a36b00" 
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Click="btnRegistrarVenta_Click" 
                                    ToolTip="Registrar venta en el sistema"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </ScrollViewer>
</Window>